<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png"><link rel="icon" href="/img/android-chrome-192x192.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Suncle Chen"><meta name="keywords" content=""><meta name="description" content="Python IO文件打开和关闭文件打开和关闭就是两个函数，一个open函数一个close函数 open函数的原型 open(file, mode&#x3D;&#39;r&#39;, buffering&#x3D;-1, encoding&#x3D;None, errors&#x3D;None, newline&#x3D;None, closefd&#x3D;True, opener&#x3D;None) 前面说open函数返回的是一个file-like对象，但是这"><meta property="og:type" content="article"><meta property="og:title" content="Python IO"><meta property="og:url" content="https://suncle.me/posts/3838453869"><meta property="og:site_name" content="Suncle"><meta property="og:description" content="Python IO文件打开和关闭文件打开和关闭就是两个函数，一个open函数一个close函数 open函数的原型 open(file, mode&#x3D;&#39;r&#39;, buffering&#x3D;-1, encoding&#x3D;None, errors&#x3D;None, newline&#x3D;None, closefd&#x3D;True, opener&#x3D;None) 前面说open函数返回的是一个file-like对象，但是这"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2017-02-13T15:36:16.000Z"><meta property="article:modified_time" content="2022-08-25T17:31:48.023Z"><meta property="article:author" content="Suncle Chen"><meta property="article:tag" content="IO"><meta property="article:tag" content="文件"><meta property="article:tag" content="目录"><meta property="article:tag" content="上下文"><meta property="article:tag" content="序列化"><meta name="twitter:card" content="summary_large_image"><meta name="referrer" content="no-referrer-when-downgrade"><title>Python IO - Suncle</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"suncle.me",root:"/",version:"1.9.2",typing:{enable:!1,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:"41fc030db57d5570dd22f78997dc4a7e",google:"UA-72506112-1",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Suncle" type="application/atom+xml">
</head><body><header><div class="header-inner" style="height:60vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Suncle&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/categories/newsletter/"><i class="iconfont icon-mail"></i> 周刊</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-books"></i> 更多</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类 </a><a class="dropdown-item" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签 </a><a class="dropdown-item" href="/atom.xml"><i class="iconfont icon-rss-fill"></i> RSS</a></div></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/suncle-banner.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle">Python IO</span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2017-02-13 23:36" pubdate>2017年2月13日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 12k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 100 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-right:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="python" id="heading-23eeeb4347bdd26bfc6b7ee9a3b755dd" role="tab" data-toggle="collapse" href="#collapse-23eeeb4347bdd26bfc6b7ee9a3b755dd" aria-expanded="true">python <span class="list-group-count">(32)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-23eeeb4347bdd26bfc6b7ee9a3b755dd" role="tabpanel" aria-labelledby="heading-23eeeb4347bdd26bfc6b7ee9a3b755dd"><div class="category-post-list"><a href="/posts/2114861712" title="Python Google Protocol Buffer" class="list-group-item list-group-item-action"><span class="category-post">Python Google Protocol Buffer</span> </a><a href="/posts/3838453869" title="Python IO" class="list-group-item list-group-item-action active"><span class="category-post">Python IO</span> </a><a href="/posts/501648532" title="Python-WSGI接口" class="list-group-item list-group-item-action"><span class="category-post">Python-WSGI接口</span> </a><a href="/posts/1140005001" title="Python-pymysql" class="list-group-item list-group-item-action"><span class="category-post">Python-pymysql</span> </a><a href="/posts/3371524817" title="Python函数" class="list-group-item list-group-item-action"><span class="category-post">Python函数</span> </a><a href="/posts/3373145519" title="Python函数定义及参数详解" class="list-group-item list-group-item-action"><span class="category-post">Python函数定义及参数详解</span> </a><a href="/posts/3953642204" title="Python单元测试" class="list-group-item list-group-item-action"><span class="category-post">Python单元测试</span> </a><a href="/posts/2639636733" title="Python基本数据类型-list-tuple-dict-set" class="list-group-item list-group-item-action"><span class="category-post">Python基本数据类型-list-tuple-dict-set</span> </a><a href="/posts/4097981062" title="Python多线程" class="list-group-item list-group-item-action"><span class="category-post">Python多线程</span> </a><a href="/posts/1609178714" title="Python字符串" class="list-group-item list-group-item-action"><span class="category-post">Python字符串</span> </a><a href="/posts/3043416172" title="Python实现通用web框架" class="list-group-item list-group-item-action"><span class="category-post">Python实现通用web框架</span> </a><a href="/posts/2568280681" title="Python常用模块集锦" class="list-group-item list-group-item-action"><span class="category-post">Python常用模块集锦</span> </a><a href="/posts/668369792" title="Python异常处理" class="list-group-item list-group-item-action"><span class="category-post">Python异常处理</span> </a><a href="/posts/3005931287" title="Python拉链法和开地址法实现字典" class="list-group-item list-group-item-action"><span class="category-post">Python拉链法和开地址法实现字典</span> </a><a href="/posts/1516127351" title="Python描述器" class="list-group-item list-group-item-action"><span class="category-post">Python描述器</span> </a><a href="/posts/2253555633" title="Python时间模块常用操作总结" class="list-group-item list-group-item-action"><span class="category-post">Python时间模块常用操作总结</span> </a><a href="/posts/858751997" title="Python答疑解惑" class="list-group-item list-group-item-action"><span class="category-post">Python答疑解惑</span> </a><a href="/posts/3541559492" title="Python网络编程" class="list-group-item list-group-item-action"><span class="category-post">Python网络编程</span> </a><a href="/posts/2033838900" title="Python装饰器" class="list-group-item list-group-item-action"><span class="category-post">Python装饰器</span> </a><a href="/posts/106366875" title="Python装饰器实现函数动态类型检查" class="list-group-item list-group-item-action"><span class="category-post">Python装饰器实现函数动态类型检查</span> </a><a href="/posts/2276895921" title="Python解构与封装" class="list-group-item list-group-item-action"><span class="category-post">Python解构与封装</span> </a><a href="/posts/2607945880" title="Python解析式" class="list-group-item list-group-item-action"><span class="category-post">Python解析式</span> </a><a href="/posts/3226889536" title="Python面向对象基础" class="list-group-item list-group-item-action"><span class="category-post">Python面向对象基础</span> </a><a href="/posts/2725239063" title="Python面向对象的魔术方法" class="list-group-item list-group-item-action"><span class="category-post">Python面向对象的魔术方法</span> </a><a href="/posts/1924480698" title="SQLAlchemy使用" class="list-group-item list-group-item-action"><span class="category-post">SQLAlchemy使用</span> </a><a href="/posts/599780751" title="【填坑系列】Python习题集" class="list-group-item list-group-item-action"><span class="category-post">【填坑系列】Python习题集</span> </a><a href="/posts/2323272316" title="【填坑系列】Python基础知识总目录" class="list-group-item list-group-item-action"><span class="category-post">【填坑系列】Python基础知识总目录</span> </a><a href="/posts/139111991" title="从Python调用堆栈获取行号等信息" class="list-group-item list-group-item-action"><span class="category-post">从Python调用堆栈获取行号等信息</span> </a><a href="/posts/10731460" title="使用Google翻译Api" class="list-group-item list-group-item-action"><span class="category-post">使用Google翻译Api</span> </a><a href="/posts/4100952181" title="微博爬取热搜榜和热门话题" class="list-group-item list-group-item-action"><span class="category-post">微博爬取热搜榜和热门话题</span> </a><a href="/posts/3984252732" title="设计一个基于flask的高并发高可用的查询ip的http服务" class="list-group-item list-group-item-action"><span class="category-post">设计一个基于flask的高并发高可用的查询ip的http服务</span> </a><a href="/posts/1143805574" title="详解supervisor进程管理" class="list-group-item list-group-item-action"><span class="category-post">详解supervisor进程管理</span></a></div></div></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">Python IO</h1><div class="markdown-body"><h1 id="Python-IO"><a href="#Python-IO" class="headerlink" title="Python IO"></a>Python IO</h1><h2 id="文件打开和关闭"><a href="#文件打开和关闭" class="headerlink" title="文件打开和关闭"></a>文件打开和关闭</h2><p>文件打开和关闭就是两个函数，一个open函数一个close函数</p><p><strong>open函数的原型</strong></p><p><code>open(file, mode=&#39;r&#39;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</code></p><p>前面说open函数返回的是一个file-like对象，但是这个file-like对象并不是固定的，这个对象的类型会随着打开mode的变化而变化。</p><ol><li>以文本模式打开文件（’w’, ‘r’，’wt’，’rt’等），返回一个TextIOWrapper。</li><li>当用二进制模式打开文件时，返回的对象也会变化。</li><li>在二进制读取模式，返回一个BufferedReader。</li><li>在二进制写模式和二进制追加模式，返回一个BufferedWriter。</li><li>在二进制读&#x2F;写模式下，返回一个BufferedRandom。</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>)	<span class="hljs-comment"># 直接open函数打开，文件不存在会FileNotFoundError</span><br>---------------------------------------------------------------------------<br>FileNotFoundError                         Traceback (most recent call last)<br>&lt;ipython-<span class="hljs-built_in">input</span>-<span class="hljs-number">1</span>-b6df97277b77&gt; <span class="hljs-keyword">in</span> &lt;module&gt;()<br>----&gt; <span class="hljs-number">1</span> f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>)<br><br>FileNotFoundError: [Errno <span class="hljs-number">2</span>] No such file <span class="hljs-keyword">or</span> directory: <span class="hljs-string">&#x27;./hello.py&#x27;</span><br><br>In [<span class="hljs-number">2</span>]: f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>)	<span class="hljs-comment"># 创建文件之后就可以打开，返回一个file-like对象</span><br><br>In [<span class="hljs-number">3</span>]: f.read()	<span class="hljs-comment"># 读出文件全部内容</span><br>Out[<span class="hljs-number">3</span>]: <span class="hljs-string">&quot;#!/usr/bin/env python\n# coding=utf-8\nprint(&#x27;hello world&#x27;)\n&quot;</span><br><br>In [<span class="hljs-number">4</span>]: f.close()	<span class="hljs-comment"># 关闭文件</span><br></code></pre></td></tr></table></figure><span id="more"></span><h2 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h2><p>文件读写主要是read和write及其变种，文件的读写依赖于open函数的mode参数。</p><h3 id="open函数的mode参数"><a href="#open函数的mode参数" class="headerlink" title="open函数的mode参数"></a>open函数的mode参数</h3><p>Mode具体含义如下</p><ul><li>‘r’ open for reading (default)</li><li>‘w’ open for writing, <strong>truncating the file first</strong></li><li>‘x’ create a new file and open it for writing</li><li>‘a’ open for writing, appending to the end of the file if it exists</li><li>‘b’ binary mode</li><li>‘t’ text mode (default)</li><li>‘+’ open a disk file for updating (reading and writing)</li><li>‘U’ universal newline mode (deprecated)</li></ul><p>说明：</p><ol><li>当mode&#x3D;’x’时，如果文件不存在，则会抛出异常 FileExistsError。</li><li>当mode&#x3D;’w’时，只要打开了文件，即使不写入内容，也会先清空文件。</li><li>当mode包含+时， 会增加额外的读写操作， 也就说原来是只读的，会增加可写的操作， 原来是只写的，会增加可读的操作，但是+不改变其他行为。</li></ol><h3 id="mode-x3D-t-amp-mode-x3D-b"><a href="#mode-x3D-t-amp-mode-x3D-b" class="headerlink" title="mode&#x3D;t&amp;mode&#x3D;b"></a>mode&#x3D;t&amp;mode&#x3D;b</h3><ul><li>mode&#x3D;t 按字符操作</li><li>mode&#x3D;b 按字节操作</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>, mode=<span class="hljs-string">&#x27;rt&#x27;</span>)	<span class="hljs-comment"># mode=t 读入的内容是字符串</span><br><br>In [<span class="hljs-number">2</span>]: s = f.read()<br><br>In [<span class="hljs-number">3</span>]: s<br>Out[<span class="hljs-number">3</span>]: <span class="hljs-string">&quot;#!/usr/bin/env python\n# coding=utf-8\nprint(&#x27;hello world&#x27;)\n&quot;</span><br><br>In [<span class="hljs-number">4</span>]: <span class="hljs-built_in">type</span>(s)	<span class="hljs-comment"># s是str类型的</span><br>Out[<span class="hljs-number">4</span>]: <span class="hljs-built_in">str</span><br><br>In [<span class="hljs-number">5</span>]: f.close()<br><br>In [<span class="hljs-number">6</span>]: f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>, mode=<span class="hljs-string">&#x27;rb&#x27;</span>)	<span class="hljs-comment"># mode=b 读入的是bytes</span><br><br>In [<span class="hljs-number">7</span>]: s = f.read()<br><br>In [<span class="hljs-number">8</span>]: s<br>Out[<span class="hljs-number">8</span>]: <span class="hljs-string">b&quot;#!/usr/bin/env python\n# coding=utf-8\nprint(&#x27;hello world&#x27;)\n&quot;</span><br><br>In [<span class="hljs-number">9</span>]: <span class="hljs-built_in">type</span>(s)<br>Out[<span class="hljs-number">9</span>]: <span class="hljs-built_in">bytes</span><br></code></pre></td></tr></table></figure><h3 id="文件指针"><a href="#文件指针" class="headerlink" title="文件指针"></a>文件指针</h3><p>当打开文件的时候， 解释器会持有一个指针， 指向文件的某个位置，当我们读写文件的时候，总是从指针处开始向后操作，并且移动指针。当mode&#x3D;r时， 指针是指向0(文件开始)，当mode&#x3D;a时， 指针指向EOF(文件末尾)</p><p>和文件指针相关的两个函数是<code>tell</code>函数和<code>seek</code>函数</p><p><strong>tell函数</strong></p><p>返回当前流的位置，对于文件来说，就是文件流的位置，即文件指针的位置。</p><p><strong>seek函数</strong></p><p>改变文件流的位置，并返回新的绝对位置。</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">seek(cookie, whence=<span class="hljs-number">0</span>, /) <span class="hljs-keyword">method</span> <span class="hljs-title function_">of</span> _<span class="hljs-title function_">io</span>.<span class="hljs-title function_">TextIOWrapper</span> <span class="hljs-title function_">instance</span><br></code></pre></td></tr></table></figure><p><strong>关于文件指针的总结</strong></p><p>当seek超出文件末尾， 不会有异常， tell也会超出文件末尾， 但是写数据的时候，还是会从文件末尾开始写</p><p>write 操作 从 min(EOF, tell())处开始</p><ul><li>文件指针按字节操作（无论是字符模式还是字节模式）</li><li>tell方法返回当前文件指针位置</li><li>seek方法移动文件指针</li><li>whence 参数 SEEK_SET(0) 从0开始向后移动offset个字节, SEEK_CUR(1) 从当前位置向后移动offset个字节, SEEK_END(2) 从EOF向后移动offset个字节</li><li>offset是整数</li><li><strong>当mode为t时， whence为SEEK_CUR或者SEEK_END时， offset只能为0</strong></li><li>文件指针不能为负数</li><li>读文件的时候从文件指针(pos)开始向后读</li><li>写文件的时候从min(EOF,pos)处开始向后写</li><li>以append模式打开的时候，无论文件指针在何处，都从EOF开始写</li></ul><h3 id="文件缓冲区"><a href="#文件缓冲区" class="headerlink" title="文件缓冲区"></a>文件缓冲区</h3><p>文件缓冲区由open函数的buffering参数决定，buffering表示缓冲方式，参数默认值为-1，表示文本模式和二进制模式都是采用默认的缓冲区。</p><p><strong>buffering&#x3D;-1</strong></p><ul><li>二进制模式： DEFAULT_BUFFER_SIZE</li><li>文本模式： DEFAULT_BUFFER_SIZE</li></ul><p><strong>buffering&#x3D;0</strong></p><ul><li>二进制模式：unbuffered</li><li>文本模式：不允许</li></ul><p><strong>buffering&#x3D;1</strong></p><ul><li>二进制模式： 1</li><li>文本模式： line buffering</li></ul><p><strong>buffering&gt;1</strong></p><ul><li>二进制模式：buffering</li><li>文本模式： DEFAULT_BUFFER_SIZE</li></ul><p><strong>总结</strong></p><ul><li><p>二进制模式： 判断缓冲区剩余位置是否足够存放当前字节，如果不能，先flush， 在把当前字节写入缓冲区，如果当前字节大于缓冲区大小， 直接flush。</p></li><li><p>文本模式： line buffering，遇到换行就flush， 非line buffering，如果当前字节加缓冲区中的字节，超出缓冲区大小，<strong>直接将缓冲区和当前字节全部flush</strong>。</p></li><li><p>flush和close可以强制刷新缓冲区。</p></li></ul><h2 id="上下文管理"><a href="#上下文管理" class="headerlink" title="上下文管理"></a>上下文管理</h2><p>上下文管理，会在离开时自动关闭文件， 但是不会开启新的作用域。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    ...:     <span class="hljs-keyword">pass</span><br>    ...: <br><br>In [<span class="hljs-number">2</span>]: f.readable()	<span class="hljs-comment"># 离开上下文管理后，文件已关闭，不可再进行I/O操作</span><br>---------------------------------------------------------------------------<br>ValueError                                Traceback (most recent call last)<br>&lt;ipython-<span class="hljs-built_in">input</span>-<span class="hljs-number">18</span>-97a5eee249a2&gt; <span class="hljs-keyword">in</span> &lt;module&gt;()<br>----&gt; <span class="hljs-number">1</span> f.readable()<br><br>ValueError: I/O operation on closed file	<br><br>In [<span class="hljs-number">3</span>]: f<br>Out[<span class="hljs-number">3</span>]: &lt;_io.TextIOWrapper name=<span class="hljs-string">&#x27;./hello.py&#x27;</span> mode=<span class="hljs-string">&#x27;r&#x27;</span> encoding=<span class="hljs-string">&#x27;UTF-8&#x27;</span>&gt;<br><br>In [<span class="hljs-number">4</span>]: f.closed	<span class="hljs-comment"># f已经关闭</span><br>Out[<span class="hljs-number">4</span>]: <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>上下文管理除了<code>with open(&#39;./hello.py&#39;) as f:</code>这种写法外，还有另外一种写法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">21</span>]: f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./hello.py&#x27;</span>)<br><br>In [<span class="hljs-number">22</span>]: <span class="hljs-keyword">with</span> f:<br>    ...:     <span class="hljs-keyword">pass</span><br>    ...:<br></code></pre></td></tr></table></figure><h2 id="File-like对象"><a href="#File-like对象" class="headerlink" title="File-like对象"></a>File-like对象</h2><p>像<code>open()</code>函数返回的这种有个<code>read()</code>方法的对象，在Python中统称为file-like Object。除了file外，还可以是内存的字节流，网络流，自定义流等等。常见的有StringIO和BytesIO。</p><h3 id="StringIO"><a href="#StringIO" class="headerlink" title="StringIO"></a>StringIO</h3><p>StringIO顾名思义就是在内存中读写str。</p><p>要把str写入StringIO，我们需要先创建一个StringIO对象，然后项文件一样写入并读取。file支持的操作StringIO基本都是支持的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> StringIO<br><br>In [<span class="hljs-number">2</span>]: <span class="hljs-built_in">help</span>(StringIO)<br><br><br>In [<span class="hljs-number">3</span>]: sio = StringIO()	<span class="hljs-comment"># 创建StringIO对象，也可以用str来初始化StringIO</span><br><br>In [<span class="hljs-number">4</span>]: sio.write(<span class="hljs-string">&#x27;hello world&#x27;</span>)<br>Out[<span class="hljs-number">4</span>]: <span class="hljs-number">11</span><br><br>In [<span class="hljs-number">5</span>]: sio.write(<span class="hljs-string">&#x27; !&#x27;</span>)<br>Out[<span class="hljs-number">5</span>]: <span class="hljs-number">2</span><br><br>In [<span class="hljs-number">6</span>]: sio.getvalue()	<span class="hljs-comment"># getvalue()方法用于获得写入后的str。</span><br>Out[<span class="hljs-number">6</span>]: <span class="hljs-string">&#x27;hello world !&#x27;</span><br><br>In [<span class="hljs-number">7</span>]: sio.closed<br>Out[<span class="hljs-number">7</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">8</span>]: sio.readline()<br>Out[<span class="hljs-number">8</span>]: <span class="hljs-string">&#x27;&#x27;</span><br><br>In [<span class="hljs-number">9</span>]: sio.seekable()<br>Out[<span class="hljs-number">9</span>]: <span class="hljs-literal">True</span><br><br>In [<span class="hljs-number">10</span>]: sio.seek(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)	<span class="hljs-comment"># 支持seek操作</span><br>Out[<span class="hljs-number">10</span>]: <span class="hljs-number">0</span><br><br>In [<span class="hljs-number">11</span>]: sio.readline()<br>Out[<span class="hljs-number">11</span>]: <span class="hljs-string">&#x27;hello world !&#x27;</span><br></code></pre></td></tr></table></figure><p>要读取StringIO，可以用一个str初始化StringIO，然后，像读文件一样读取：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> StringIO<br><br>In [<span class="hljs-number">2</span>]: sio = StringIO(<span class="hljs-string">&#x27;I\nlove\npython!&#x27;</span>)<br><br>In [<span class="hljs-number">3</span>]: <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> sio.readlines():<br>   ...:     <span class="hljs-built_in">print</span>(line.strip())<br>   ...:     <br>I<br>love<br>python!<br></code></pre></td></tr></table></figure><h3 id="BytesIO"><a href="#BytesIO" class="headerlink" title="BytesIO"></a>BytesIO</h3><p>StringIO操作的只能是str，如果要操作二进制数据，就需要使用BytesIO。</p><p>BytesIO实现了在内存中读写bytes，我们创建一个BytesIO，然后写入一些bytes：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><br>In [<span class="hljs-number">2</span>]: bio = BytesIO()<br><br>In [<span class="hljs-number">3</span>]: bio.write(<span class="hljs-string">b&#x27;abcd&#x27;</span>)<br>Out[<span class="hljs-number">3</span>]: <span class="hljs-number">4</span><br><br>In [<span class="hljs-number">4</span>]: bio.seek(<span class="hljs-number">0</span>)<br>Out[<span class="hljs-number">4</span>]: <span class="hljs-number">0</span><br><br>In [<span class="hljs-number">5</span>]: bio.read()<br>Out[<span class="hljs-number">5</span>]: <span class="hljs-string">b&#x27;abcd&#x27;</span><br><br>In [<span class="hljs-number">6</span>]: bio.getvalue()	<span class="hljs-comment"># getvalue 可以一次性独处全部内容，不管文件指针在哪里</span><br>Out[<span class="hljs-number">6</span>]: <span class="hljs-string">b&#x27;abcd&#x27;</span><br></code></pre></td></tr></table></figure><p>和StringIO类似，可以用一个bytes初始化BytesIO，然后，像读文件一样读取：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><br>In [<span class="hljs-number">2</span>]: bio = BytesIO(<span class="hljs-string">b&#x27;abcd&#x27;</span>)<br><br>In [<span class="hljs-number">3</span>]: bio.read()<br>Out[<span class="hljs-number">3</span>]: <span class="hljs-string">b&#x27;abcd&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="路径操作pathlib"><a href="#路径操作pathlib" class="headerlink" title="路径操作pathlib"></a>路径操作pathlib</h2><p>路径操作有os.path和pathlib两种方式。</p><ul><li>os.path是已字符串的方式操作路径的：<code>import os</code></li><li>pathlib是面向对象设计的文件系统路径：<code>import pathlib</code></li></ul><p>pathlib在python3.2以上开始默认支持，在python2.7中如果要使用pathlib需要安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install pathlib<br></code></pre></td></tr></table></figure><p>pathlib模块的源代码见：Lib&#x2F;pathlib.py</p><h3 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h3><p>pathlib目录的基本使用是pathlib模块中的Path这个类。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> pathlib	<span class="hljs-comment"># 引入pathlib这个模块</span><br><br>In [<span class="hljs-number">2</span>]: cwd = pathlib.Path(<span class="hljs-string">&#x27;.&#x27;</span>)	<span class="hljs-comment"># 使用pathlib模块的Path类初始化当前路径，参数是一个PurePath</span><br><br>In [<span class="hljs-number">3</span>]: cwd	<span class="hljs-comment"># 返回值是一个PosixPath，如果是windows环境会返回一个WindowsPath</span><br>Out[<span class="hljs-number">3</span>]: PosixPath(<span class="hljs-string">&#x27;.&#x27;</span>)<br></code></pre></td></tr></table></figure><p>通过<code>help(pathlib.Path)</code>可以查看到Path类的各个Methods。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">Help on <span class="hljs-keyword">class</span> <span class="hljs-title class_">Path</span> <span class="hljs-keyword">in</span> module pathlib:<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Path</span>(<span class="hljs-title class_ inherited__">PurePath</span>)<br> |  PurePath represents a filesystem path <span class="hljs-keyword">and</span> offers operations which<br> |  don<span class="hljs-string">&#x27;t imply any actual filesystem I/O.  Depending on your system,</span><br><span class="hljs-string"> |  instantiating a PurePath will return either a PurePosixPath or a</span><br><span class="hljs-string"> |  PureWindowsPath object.  You can also instantiate either of these classes</span><br><span class="hljs-string"> |  directly, regardless of your system.</span><br><span class="hljs-string"> |  </span><br><span class="hljs-string"> |  Method resolution order:</span><br><span class="hljs-string"> |      Path</span><br><span class="hljs-string"> |      PurePath</span><br><span class="hljs-string"> |      builtins.object</span><br><span class="hljs-string"> |  </span><br><span class="hljs-string"> |  Methods defined here:</span><br><span class="hljs-string"> |  </span><br><span class="hljs-string"> |  __enter__(self)</span><br><span class="hljs-string"> |  </span><br><span class="hljs-string"> |  __exit__(self, t, v, tb)</span><br><span class="hljs-string"> |  </span><br><span class="hljs-string">...</span><br></code></pre></td></tr></table></figure><p>目录操作的几个函数：</p><ul><li><code>is_dir(self)</code>：判断路径是否是目录</li><li><code>iterdir(self)</code>：生成当前路径下所有文件(包括文件夹)的生成器，但是不会yield ‘.’ 和’..’这两个路径</li><li><code>mkdir(self, mode=511, parents=False, exist_ok=False)</code>：删除当前目录，可以指定mode</li><li><code>rmdir(self)</code>：删除目录，并且目录必须为空，否则会报错</li></ul><p>使用示例如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">4</span>]: cwd.is_dir()<br>Out[<span class="hljs-number">4</span>]: <span class="hljs-literal">True</span><br><br>In [<span class="hljs-number">5</span>]: cwd.iterdir()	<span class="hljs-comment"># iterdir函数返回的是一个生成器</span><br>Out[<span class="hljs-number">5</span>]: &lt;generator <span class="hljs-built_in">object</span> Path.iterdir at <span class="hljs-number">0x7f6727d926d0</span>&gt;<br><br>In [<span class="hljs-number">6</span>]: <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> cwd.iterdir():	<span class="hljs-comment"># 不会生成&#x27;.&#x27; 和&#x27;..&#x27;</span><br>   ...:     <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(f))<br>   ...:     <span class="hljs-built_in">print</span>(f)<br>   ...:     <br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pathlib.PosixPath&#x27;</span>&gt;<br>hello.py<br>&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;pathlib.PosixPath&#x27;</span>&gt;<br>aa.py<br><br>In [<span class="hljs-number">7</span>]: cwd.mkdir(<span class="hljs-string">&#x27;abc&#x27;</span>)	<span class="hljs-comment"># pathlib的mkdir是路径对象的方法</span><br>---------------------------------------------------------------------------<br>TypeError                                 Traceback (most recent call last)<br>&lt;ipython-<span class="hljs-built_in">input</span>-<span class="hljs-number">7</span>-3b48dd61eb0f&gt; <span class="hljs-keyword">in</span> &lt;module&gt;()<br>----&gt; <span class="hljs-number">1</span> cwd.mkdir(<span class="hljs-string">&#x27;abc&#x27;</span>)<br><br>/home/clg/.pyenv/versions/<span class="hljs-number">3.5</span><span class="hljs-number">.2</span>/lib/python3<span class="hljs-number">.5</span>/pathlib.py <span class="hljs-keyword">in</span> mkdir(self, mode, parents, exist_ok)<br>   <span class="hljs-number">1212</span>         <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> parents:<br>   <span class="hljs-number">1213</span>             <span class="hljs-keyword">try</span>:<br>-&gt; <span class="hljs-number">1214</span>                 self._accessor.mkdir(self, mode)<br>   <span class="hljs-number">1215</span>             <span class="hljs-keyword">except</span> FileExistsError:<br>   <span class="hljs-number">1216</span>                 <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> exist_ok <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> self.is_dir():<br><br>/home/clg/.pyenv/versions/<span class="hljs-number">3.5</span><span class="hljs-number">.2</span>/lib/python3<span class="hljs-number">.5</span>/pathlib.py <span class="hljs-keyword">in</span> wrapped(pathobj, *args)<br>    <span class="hljs-number">369</span>         @functools.wraps(strfunc)<br>    <span class="hljs-number">370</span>         <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapped</span>(<span class="hljs-params">pathobj, *args</span>):<br>--&gt; <span class="hljs-number">371</span>             <span class="hljs-keyword">return</span> strfunc(<span class="hljs-built_in">str</span>(pathobj), *args)<br>    <span class="hljs-number">372</span>         <span class="hljs-keyword">return</span> <span class="hljs-built_in">staticmethod</span>(wrapped)<br>    <span class="hljs-number">373</span> <br><br>TypeError: an integer <span class="hljs-keyword">is</span> required (got <span class="hljs-built_in">type</span> <span class="hljs-built_in">str</span>)<br><br>In [<span class="hljs-number">8</span>]: d = pathlib.Path(<span class="hljs-string">&#x27;./abc&#x27;</span>)<br><br>In [<span class="hljs-number">9</span>]: d.exists()<br>Out[<span class="hljs-number">9</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">10</span>]: d.mkdir(<span class="hljs-number">755</span>)	 <span class="hljs-comment"># 创建文件夹，但是755不等于0o755(8进制)</span><br><br>In [<span class="hljs-number">11</span>]: %ls<br>aa.py  abc/  hello.py<br><br>In [<span class="hljs-number">12</span>]: %ls -ld ./abc<br>d-wxrw---t. <span class="hljs-number">2</span> clg clg <span class="hljs-number">6</span> Feb <span class="hljs-number">13</span> <span class="hljs-number">21</span>:01 ./abc/	<span class="hljs-comment"># mode指定有问题，所以权限不正常</span><br><br>In [<span class="hljs-number">13</span>]: d.rmdir()<br><br>In [<span class="hljs-number">14</span>]: d.exists()<br>Out[<span class="hljs-number">14</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">15</span>]: d.mkdir(<span class="hljs-number">0o755</span>)	<span class="hljs-comment"># 使用8进制指定mode</span><br><br>In [<span class="hljs-number">16</span>]: %ls -ld ./abc<br>drwxr-xr-x. <span class="hljs-number">2</span> clg clg <span class="hljs-number">6</span> Feb <span class="hljs-number">13</span> <span class="hljs-number">21</span>:03 ./abc/<br></code></pre></td></tr></table></figure><h3 id="通用操作"><a href="#通用操作" class="headerlink" title="通用操作"></a>通用操作</h3><p>主要是一些路径的通用操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">17</span>]: f = pathlib.Path(<span class="hljs-string">&#x27;./ab/cd/a.txt&#x27;</span>)<br><br>In [<span class="hljs-number">18</span>]: f.exists()<br>Out[<span class="hljs-number">18</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">19</span>]: f.is_file()<br>Out[<span class="hljs-number">19</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">20</span>]: f.is_absolute()<br>Out[<span class="hljs-number">20</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">21</span>]: f = pathlib.Path(<span class="hljs-string">&#x27;./hello.py&#x27;</span>)<br><br>In [<span class="hljs-number">22</span>]: f.is_file()<br>Out[<span class="hljs-number">22</span>]: <span class="hljs-literal">True</span><br><br>In [<span class="hljs-number">23</span>]: f.is_absolute()<br>Out[<span class="hljs-number">23</span>]: <span class="hljs-literal">False</span><br><br>In [<span class="hljs-number">24</span>]: f.absolute()	<span class="hljs-comment"># 获取路径的绝对路径</span><br>Out[<span class="hljs-number">24</span>]: PosixPath(<span class="hljs-string">&#x27;/home/clg/workspace/subworkspace/hello.py&#x27;</span>)<br><br>In [<span class="hljs-number">25</span>]: f.chmod(<span class="hljs-number">0o755</span>)	<span class="hljs-comment"># 改变路径的权限</span><br><br>In [<span class="hljs-number">26</span>]: %ls -ld ./hello.py<br>-rwxr-xr-x. <span class="hljs-number">1</span> clg clg <span class="hljs-number">58</span> Feb  <span class="hljs-number">8</span> <span class="hljs-number">13</span>:<span class="hljs-number">32</span> ./hello.py*<br><br>In [<span class="hljs-number">27</span>]: f.cwd()	<span class="hljs-comment"># 返回一个新路径指向当前工作目录</span><br>Out[<span class="hljs-number">27</span>]: PosixPath(<span class="hljs-string">&#x27;/home/clg/workspace/subworkspace&#x27;</span>)<br><br>In [<span class="hljs-number">28</span>]: f.home()<br>Out[<span class="hljs-number">28</span>]: PosixPath(<span class="hljs-string">&#x27;/home/clg&#x27;</span>)<br><br>In [<span class="hljs-number">29</span>]: pathlib.Path(<span class="hljs-string">&#x27;~&#x27;</span>).expanduser()	<span class="hljs-comment"># 将~转换成功绝对路径</span><br>Out[<span class="hljs-number">29</span>]: PosixPath(<span class="hljs-string">&#x27;/home/clg&#x27;</span>)<br><br>In [<span class="hljs-number">30</span>]: f.name()	<span class="hljs-comment"># name是一个属性，不是一个方法</span><br>---------------------------------------------------------------------------<br>TypeError                                 Traceback (most recent call last)<br>&lt;ipython-<span class="hljs-built_in">input</span>-<span class="hljs-number">30</span>-f0ea48ccc8ff&gt; <span class="hljs-keyword">in</span> &lt;module&gt;()<br>----&gt; <span class="hljs-number">1</span> f.name()<br><br>TypeError: <span class="hljs-string">&#x27;str&#x27;</span> <span class="hljs-built_in">object</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">callable</span><br><br>In [<span class="hljs-number">31</span>]: f.name	<span class="hljs-comment"># 获取得到的是基本名称basename</span><br>Out[<span class="hljs-number">31</span>]: <span class="hljs-string">&#x27;hello.py&#x27;</span><br><br>In [<span class="hljs-number">32</span>]: f.home().name<br>Out[<span class="hljs-number">32</span>]: <span class="hljs-string">&#x27;clg&#x27;</span><br><br>In [<span class="hljs-number">33</span>]: f.owner()	<span class="hljs-comment"># 获取属主</span><br>Out[<span class="hljs-number">33</span>]: <span class="hljs-string">&#x27;clg&#x27;</span><br><br>In [<span class="hljs-number">34</span>]: f.home().parent<br>Out[<span class="hljs-number">34</span>]: PosixPath(<span class="hljs-string">&#x27;/home&#x27;</span>)<br><br>In [<span class="hljs-number">35</span>]: f.parts<br>Out[<span class="hljs-number">35</span>]: (<span class="hljs-string">&#x27;hello.py&#x27;</span>,)<br><br>In [<span class="hljs-number">36</span>]: f.absolute().parts	<span class="hljs-comment"># 获取路径的拆分</span><br>Out[<span class="hljs-number">36</span>]: (<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;home&#x27;</span>, <span class="hljs-string">&#x27;clg&#x27;</span>, <span class="hljs-string">&#x27;workspace&#x27;</span>, <span class="hljs-string">&#x27;subworkspace&#x27;</span>, <span class="hljs-string">&#x27;hello.py&#x27;</span>)<br><br>In [<span class="hljs-number">37</span>]: f.root	<span class="hljs-comment"># 获取根目录，但是&#x27;./hello.py&#x27;获取到的则是&#x27;.&#x27;</span><br>Out[<span class="hljs-number">37</span>]: <span class="hljs-string">&#x27;&#x27;</span><br><br>In [<span class="hljs-number">38</span>]: f.home().root	<span class="hljs-comment"># 获取根目录</span><br>Out[<span class="hljs-number">38</span>]: <span class="hljs-string">&#x27;/&#x27;</span><br><br>In [<span class="hljs-number">39</span>]: f.suffix	<span class="hljs-comment"># 获取后缀</span><br>Out[<span class="hljs-number">39</span>]: <span class="hljs-string">&#x27;.py&#x27;</span><br><br>In [<span class="hljs-number">40</span>]: f.stat()	<span class="hljs-comment"># 类似os.stat()，返回路径的各项信息</span><br>Out[<span class="hljs-number">40</span>]: os.stat_result(st_mode=<span class="hljs-number">33261</span>, st_ino=<span class="hljs-number">34951327</span>, st_dev=<span class="hljs-number">64768</span>, st_nlink=<span class="hljs-number">1</span>, st_uid=<span class="hljs-number">1000</span>, st_gid=<span class="hljs-number">1000</span>, st_size=<span class="hljs-number">58</span>, st_atime=<span class="hljs-number">1486531928</span>, st_mtime=<span class="hljs-number">1486531926</span>, st_ctime=<span class="hljs-number">1486995977</span>)<br><br>In [<span class="hljs-number">41</span>]: f.stat().st_mode	<span class="hljs-comment"># 获取stat()返回结果中的各个信息的方法：使用&#x27;.&#x27;</span><br>Out[<span class="hljs-number">41</span>]: <span class="hljs-number">33261</span><br><br>In [<span class="hljs-number">42</span>]: d = pathlib.Path(<span class="hljs-string">&#x27;..&#x27;</span>)<br><br>In [<span class="hljs-number">43</span>]: <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d.glob(*.py):	<span class="hljs-comment"># rglob(self, pattern)参数是一个pattern</span><br>  File <span class="hljs-string">&quot;&lt;ipython-input-43-3fdfb8e408ac&gt;&quot;</span>, line <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d.glob(*.py):<br>                     ^<br>SyntaxError: invalid syntax<br><br><br>In [<span class="hljs-number">44</span>]: <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d.glob(<span class="hljs-string">&#x27;*.py&#x27;</span>):	<span class="hljs-comment"># 返回当前路径下的通配文件</span><br>    ...:     <span class="hljs-built_in">print</span>(x)<br>    ...:     <br>../judge.py<br>../progress.py<br>../zipperMethod.py<br>../decorator.py<br><br>In [<span class="hljs-number">45</span>]: <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> d.rglob(<span class="hljs-string">&#x27;*.py&#x27;</span>):	<span class="hljs-comment"># 返回当前路径下及其子路径下的通配文件（递归）</span><br>    ...:     <span class="hljs-built_in">print</span>(x)<br>    ...:     <br>../judge.py<br>../progress.py<br>../zipperMethod.py<br>../decorator.py<br>../subworkspace/hello.py<br>../subworkspace/aa.py<br></code></pre></td></tr></table></figure><h3 id="文件复制移动删除"><a href="#文件复制移动删除" class="headerlink" title="文件复制移动删除"></a>文件复制移动删除</h3><p>使用<code>shutil</code>模块即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> shutil<br></code></pre></td></tr></table></figure><ul><li>shutil.copyfileobj # 操作对象是文件对象</li><li>shutil.copyfile # 仅复制内容</li><li>shutil.copymode # 仅复制权限</li><li>shutil.copystat # 仅复制元数据</li><li>shutil.copy # 复制文件内容和权限 copyfile + copymode</li><li>shutil.copy2 # 复制文件内容和元数据 copyfile + copystat</li><li>shutil.copytree # 递归复制目录</li><li>shutil.rmtree # 用于递归删除目录</li><li>shutil.move # 具体实现依赖操作系统， 如果操作系统实现了 rename系统调用， 直接走rename系统调用，如果没实现，先使用copytree复制， 然后使用rmtree删除源文件</li></ul><h2 id="序列化和反序列化"><a href="#序列化和反序列化" class="headerlink" title="序列化和反序列化"></a>序列化和反序列化</h2><ul><li>序列化： 对象转化为数据</li><li>反序列化： 数据转化为对象</li></ul><h3 id="Python私有协议pickle"><a href="#Python私有协议pickle" class="headerlink" title="Python私有协议pickle"></a>Python私有协议pickle</h3><p>pickle 是Python私有的序列化协议</p><p>pickle源代码见：lib&#x2F;python3.5&#x2F;pickle.py</p><p>主要函数</p><ul><li><code>dumps</code> 对象导出为数据，即序列化</li><li><code>loads</code> 数据载入为对象，即反序列化，反序列化一个对象时，必须存在此对象的类</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> pickle<br><br>In [<span class="hljs-number">2</span>]: <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>:	<span class="hljs-comment"># 声明一个类A</span><br>   ...:     <span class="hljs-keyword">def</span> <span class="hljs-title function_">print</span>(<span class="hljs-params">self</span>):<br>   ...:         <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;aaaa&#x27;</span>)<br>   ...:         <br><br>In [<span class="hljs-number">3</span>]: a = A()	<span class="hljs-comment"># 定义类A的一个对象a</span><br><br>In [<span class="hljs-number">4</span>]: pickle.dumps(a)	<span class="hljs-comment"># 对象导出为数据</span><br>Out[<span class="hljs-number">4</span>]: <span class="hljs-string">b&#x27;\x80\x03c__main__\nA\nq\x00)\x81q\x01.&#x27;</span><br><br>In [<span class="hljs-number">5</span>]: b = pickle.dumps(a)<br><br>In [<span class="hljs-number">6</span>]: pickle.loads(b)	<span class="hljs-comment"># 数据导出为对象</span><br>Out[<span class="hljs-number">6</span>]: &lt;__main__.A at <span class="hljs-number">0x7f5dcdc71dd8</span>&gt;<br><br>In [<span class="hljs-number">7</span>]: a<br>Out[<span class="hljs-number">7</span>]: &lt;__main__.A at <span class="hljs-number">0x7f5dcdd28be0</span>&gt;	<span class="hljs-comment"># 两个对象的地址不一样，但是两个对象的内容确实一样的</span><br><br>In [<span class="hljs-number">8</span>]: aa = pickle.loads(b)<br><br>In [<span class="hljs-number">9</span>]: a.<span class="hljs-built_in">print</span>()	<span class="hljs-comment"># 原始对象的print函数</span><br>aaaa<br><br>In [<span class="hljs-number">10</span>]: aa.<span class="hljs-built_in">print</span>()	<span class="hljs-comment"># 反序列化对象的print函数</span><br>aaaa<br></code></pre></td></tr></table></figure><h3 id="通用的json协议"><a href="#通用的json协议" class="headerlink" title="通用的json协议"></a>通用的json协议</h3><p>JSON格式支持的数据类型如下</p><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>Number</td><td>在JavaScript中的双精度浮点格式</td></tr><tr><td>String</td><td>双引号的反斜杠转义的Unicode，<strong>对应python中的str</strong></td></tr><tr><td>Boolean</td><td>true 或 false</td></tr><tr><td>Array</td><td>值的有序序列，<strong>对应python中的list</strong></td></tr><tr><td>Value</td><td>它可以是一个字符串，一个数字，真的还是假（true&#x2F;false），空(null )等</td></tr><tr><td>Object</td><td>无序集合键值对，<strong>对应python中的dict</strong></td></tr><tr><td>Whitespace</td><td>可以使用任何一对中的令牌</td></tr><tr><td>null</td><td>empty</td></tr></tbody></table><p>使用示例如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">In [<span class="hljs-number">1</span>]: <span class="hljs-keyword">import</span> json<br><br>In [<span class="hljs-number">2</span>]: d = &#123;<span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;b&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]&#125;<br><br>In [<span class="hljs-number">3</span>]: json.dumps(d)<br>Out[<span class="hljs-number">3</span>]: <span class="hljs-string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: [1, 2, 3]&#125;&#x27;</span><br><br>In [<span class="hljs-number">4</span>]: json.loads(<span class="hljs-string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: [1, 2, 3]&#125;&#x27;</span>)<br>Out[<span class="hljs-number">4</span>]: &#123;<span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;b&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]&#125;<br></code></pre></td></tr></table></figure><p>json参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/SkySoot/archive/2012/04/17/2453010.html">JSON 数据格式</a></p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/python/" class="category-chain-item">python</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/IO/">#IO</a> <a href="/tags/%E6%96%87%E4%BB%B6/">#文件</a> <a href="/tags/%E7%9B%AE%E5%BD%95/">#目录</a> <a href="/tags/%E4%B8%8A%E4%B8%8B%E6%96%87/">#上下文</a> <a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/">#序列化</a></div></div><div class="license-box my-3"><div class="license-title"><div>Python IO</div><div>https://suncle.me/posts/3838453869</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Suncle Chen</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2017年2月13日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/posts/2033838900" title="Python装饰器"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Python装饰器</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/posts/3005931287" title="Python拉链法和开地址法实现字典"><span class="hidden-mobile">Python拉链法和开地址法实现字典</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><script type="text/javascript">Fluid.utils.loadComments("#comments",(function(){var t=document.documentElement.getAttribute("data-user-color-scheme");t="dark"===t?"github-dark":"github-light",window.UtterancesThemeLight="github-light",window.UtterancesThemeDark="github-dark";var e=document.createElement("script");e.setAttribute("src","https://utteranc.es/client.js"),e.setAttribute("repo","suncle1993/suncle1993.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("label","utterances"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(e)}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var o=jQuery("#board-ctn").offset().top;window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-o}),t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),n=[];for(var i of o)n.push(".markdown-body > "+i.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>