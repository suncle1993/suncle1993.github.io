

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" href="/img/android-chrome-192x192.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Suncle Chen">
  <meta name="keywords" content="">
  
    <meta name="description" content="单元测试什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and o">
<meta property="og:type" content="article">
<meta property="og:title" content="Python单元测试">
<meta property="og:url" content="https://suncle.me/2017/11/14/python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="Suncle">
<meta property="og:description" content="单元测试什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and o">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/image/blog/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95mock%E5%A4%A7%E7%89%9B%E5%9B%9E%E5%A4%8D.png">
<meta property="article:published_time" content="2017-11-14T12:01:27.000Z">
<meta property="article:modified_time" content="2022-08-25T03:41:39.049Z">
<meta property="article:author" content="Suncle Chen">
<meta property="article:tag" content="测试">
<meta property="article:tag" content="单元测试">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/image/blog/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95mock%E5%A4%A7%E7%89%9B%E5%9B%9E%E5%A4%8D.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Python单元测试 - Suncle</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"suncle.me","root":"/","version":"1.9.2","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":"41fc030db57d5570dd22f78997dc4a7e","google":"UA-72506112-1","gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Suncle" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Suncle&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/newsletter/">
                <i class="iconfont icon-mail"></i>
                周刊
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                更多
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    分类
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    标签
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/atom.xml">
                    <i class="iconfont icon-rss-fill"></i>
                    RSS
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/suncle-banner.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">Python单元测试</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2017-11-14 20:01" pubdate>
          2017年11月14日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          61 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="python"
        id="heading-23eeeb4347bdd26bfc6b7ee9a3b755dd" role="tab" data-toggle="collapse" href="#collapse-23eeeb4347bdd26bfc6b7ee9a3b755dd"
        aria-expanded="true"
      >
        python
        <span class="list-group-count">(32)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-23eeeb4347bdd26bfc6b7ee9a3b755dd"
           role="tabpanel" aria-labelledby="heading-23eeeb4347bdd26bfc6b7ee9a3b755dd">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2018/02/06/python-google-protocol-buffer/" title="Python Google Protocol Buffer"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python Google Protocol Buffer</span>
        </a>
      
    
      
      
        <a href="/2017/02/13/python-io/" title="Python IO"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python IO</span>
        </a>
      
    
      
      
        <a href="/2017/04/07/python-wsgi%E6%8E%A5%E5%8F%A3/" title="Python-WSGI接口"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python-WSGI接口</span>
        </a>
      
    
      
      
        <a href="/2017/04/14/python-pymysql/" title="Python-pymysql"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python-pymysql</span>
        </a>
      
    
      
      
        <a href="/2017/01/07/python%E5%87%BD%E6%95%B0/" title="Python函数"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python函数</span>
        </a>
      
    
      
      
        <a href="/2016/09/05/python%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E5%8F%8A%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3/" title="Python函数定义及参数详解"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python函数定义及参数详解</span>
        </a>
      
    
      
      
        <a href="/2017/11/14/python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" title="Python单元测试"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">Python单元测试</span>
        </a>
      
    
      
      
        <a href="/2016/09/02/python%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-list-tuple-dict-set/" title="Python基本数据类型-list-tuple-dict-set"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python基本数据类型-list-tuple-dict-set</span>
        </a>
      
    
      
      
        <a href="/2017/03/23/python%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="Python多线程"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python多线程</span>
        </a>
      
    
      
      
        <a href="/2016/08/30/python%E5%AD%97%E7%AC%A6%E4%B8%B2/" title="Python字符串"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python字符串</span>
        </a>
      
    
      
      
        <a href="/2017/05/22/python%E5%AE%9E%E7%8E%B0%E9%80%9A%E7%94%A8web%E6%A1%86%E6%9E%B6/" title="Python实现通用web框架"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python实现通用web框架</span>
        </a>
      
    
      
      
        <a href="/2018/03/12/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E9%9B%86%E9%94%A6/" title="Python常用模块集锦"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python常用模块集锦</span>
        </a>
      
    
      
      
        <a href="/2017/03/05/python%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" title="Python异常处理"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python异常处理</span>
        </a>
      
    
      
      
        <a href="/2017/01/12/python%E6%8B%89%E9%93%BE%E6%B3%95%E5%92%8C%E5%BC%80%E5%9C%B0%E5%9D%80%E6%B3%95%E5%AE%9E%E7%8E%B0%E5%AD%97%E5%85%B8/" title="Python拉链法和开地址法实现字典"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python拉链法和开地址法实现字典</span>
        </a>
      
    
      
      
        <a href="/2017/03/16/python%E6%8F%8F%E8%BF%B0%E5%99%A8/" title="Python描述器"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python描述器</span>
        </a>
      
    
      
      
        <a href="/2017/09/07/python%E6%97%B6%E9%97%B4%E6%A8%A1%E5%9D%97%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E6%80%BB%E7%BB%93/" title="Python时间模块常用操作总结"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python时间模块常用操作总结</span>
        </a>
      
    
      
      
        <a href="/2016/12/04/python%E7%AD%94%E7%96%91%E8%A7%A3%E6%83%91/" title="Python答疑解惑"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python答疑解惑</span>
        </a>
      
    
      
      
        <a href="/2017/03/24/python%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="Python网络编程"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python网络编程</span>
        </a>
      
    
      
      
        <a href="/2017/02/15/python%E8%A3%85%E9%A5%B0%E5%99%A8/" title="Python装饰器"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python装饰器</span>
        </a>
      
    
      
      
        <a href="/2017/02/16/python%E8%A3%85%E9%A5%B0%E5%99%A8%E5%AE%9E%E7%8E%B0%E5%87%BD%E6%95%B0%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5/" title="Python装饰器实现函数动态类型检查"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python装饰器实现函数动态类型检查</span>
        </a>
      
    
      
      
        <a href="/2016/12/23/python%E8%A7%A3%E6%9E%84%E4%B8%8E%E5%B0%81%E8%A3%85/" title="Python解构与封装"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python解构与封装</span>
        </a>
      
    
      
      
        <a href="/2017/01/11/python%E8%A7%A3%E6%9E%90%E5%BC%8F/" title="Python解析式"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python解析式</span>
        </a>
      
    
      
      
        <a href="/2017/03/08/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/" title="Python面向对象基础"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python面向对象基础</span>
        </a>
      
    
      
      
        <a href="/2017/03/15/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/" title="Python面向对象的魔术方法"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">Python面向对象的魔术方法</span>
        </a>
      
    
      
      
        <a href="/2017/05/10/sqlalchemy%E4%BD%BF%E7%94%A8/" title="SQLAlchemy使用"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">SQLAlchemy使用</span>
        </a>
      
    
      
      
        <a href="/2016/12/13/%E3%80%90%E5%A1%AB%E5%9D%91%E7%B3%BB%E5%88%97%E3%80%91python%E4%B9%A0%E9%A2%98%E9%9B%86/" title="【填坑系列】Python习题集"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【填坑系列】Python习题集</span>
        </a>
      
    
      
      
        <a href="/2016/12/04/%E3%80%90%E5%A1%AB%E5%9D%91%E7%B3%BB%E5%88%97%E3%80%91python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%80%BB%E7%9B%AE%E5%BD%95/" title="【填坑系列】Python基础知识总目录"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">【填坑系列】Python基础知识总目录</span>
        </a>
      
    
      
      
        <a href="/2017/10/31/%E4%BB%8Epython%E8%B0%83%E7%94%A8%E5%A0%86%E6%A0%88%E8%8E%B7%E5%8F%96%E8%A1%8C%E5%8F%B7%E7%AD%89%E4%BF%A1%E6%81%AF/" title="从Python调用堆栈获取行号等信息"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">从Python调用堆栈获取行号等信息</span>
        </a>
      
    
      
      
        <a href="/2018/03/22/%E4%BD%BF%E7%94%A8google%E7%BF%BB%E8%AF%91api/" title="使用Google翻译Api"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">使用Google翻译Api</span>
        </a>
      
    
      
      
        <a href="/2018/04/10/%E5%BE%AE%E5%8D%9A%E7%88%AC%E5%8F%96%E7%83%AD%E6%90%9C%E6%A6%9C%E5%92%8C%E7%83%AD%E9%97%A8%E8%AF%9D%E9%A2%98/" title="微博爬取热搜榜和热门话题"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">微博爬取热搜榜和热门话题</span>
        </a>
      
    
      
      
        <a href="/2017/08/16/%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8Eflask%E7%9A%84%E9%AB%98%E5%B9%B6%E5%8F%91%E9%AB%98%E5%8F%AF%E7%94%A8%E7%9A%84%E6%9F%A5%E8%AF%A2ip%E7%9A%84http%E6%9C%8D%E5%8A%A1/" title="设计一个基于flask的高并发高可用的查询ip的http服务"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">设计一个基于flask的高并发高可用的查询ip的http服务</span>
        </a>
      
    
      
      
        <a href="/2017/09/25/%E8%AF%A6%E8%A7%A3supervisor%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="详解supervisor进程管理"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">详解supervisor进程管理</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Python单元测试</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h1><p>什么是单元测试, 维基百科上是这么定义的： unit testing is a method by which individual units of source code, sets of one or more computer program modules together with associated control data, usage procedures, and operating procedures, are tested to determine if they are fit for use.[1] Intuitively, one can view a unit as the smallest testable part of an application. 简而言之，就是验证系统中最小可测试单元的功能是否正确的自动化测试。因此，单元测试的目地就是“对被测试对象的职责进行验证”, 在写单元测试之前，先识别出被测试对象的职责，就知道该怎么写这个单元测试了。</p>
<p>根据被测试对象，单元测试可以分为两大类：</p>
<ul>
<li>对不依赖于外部资源的组件的单元测试：使用unittest基本功能即可</li>
<li>对依赖于外部资源的组件的单元测试：需要使用mock</li>
</ul>
<span id="more"></span>

<h1 id="unittest使用"><a href="#unittest使用" class="headerlink" title="unittest使用"></a>unittest使用</h1><p>python单元测试库unittest的基本使用参见<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191629979802b566644aa84656b50cd484ec4a7838000">廖雪峰Python单元测试</a></p>
<p>具体使用参考以下资料</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://pm.readthedocs.io/unittest/python.html">Python中的单元测试</a></li>
<li><a target="_blank" rel="noopener" href="http://ningning.today/2016/11/22/python/flask-unittest/">ningning.today-flask项目单元测试实践</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/2/library/unittest.html">Python unittest官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.jikexueyuan.com/project/explore-python/Testing/README.html">极客学院-单元测试</a></li>
<li><a target="_blank" rel="noopener" href="http://nicholas.ren/2012/10/21/my-understanding-on-unit-testing.html">nicholas-怎样写单元测试</a></li>
</ol>
<h1 id="mock"><a href="#mock" class="headerlink" title="mock"></a>mock</h1><p>为什么要用mock？</p>
<p><img src="https://flowsnow.oss-cn-shanghai.aliyuncs.com/history/image/blog/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95mock%E5%A4%A7%E7%89%9B%E5%9B%9E%E5%A4%8D.png" srcset="/img/loading.gif" lazyload></p>
<p>看了很多篇mock的讲解，写的最好的一篇是[<a target="_blank" rel="noopener" href="https://www.toptal.com/python/an-introduction-to-mocking-in-python">Naftuli Kay-An Introduction to Mocking in Python</a>，以删除文件为例组成深入讲解mock的使用。其他资料可以参见：</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://andrewliu.in/2015/12/12/Python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%92%8CMock%E6%B5%8B%E8%AF%95/">Python单元测试和Mock测试</a></li>
<li><a target="_blank" rel="noopener" href="http://www.voidspace.org.uk/python/mock/helpers.html#autospeccing">mock-autospec</a></li>
</ol>
<p>仿照这篇文章改写qk_log日志模块，qk_log.py代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> logging.handlers<br><br>_console_logger = <span class="hljs-literal">None</span><br>_warn_logger = <span class="hljs-literal">None</span><br>_error_logger = <span class="hljs-literal">None</span><br><br>CONSOLE_FILENAME = <span class="hljs-string">&#x27;log/console.log&#x27;</span><br>WARNING_FILENAME = <span class="hljs-string">&#x27;log/warn.log&#x27;</span><br>ERROR_FILENAME = <span class="hljs-string">&#x27;log/error.log&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">log_init</span>():<br>    <span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&#x27;log/&#x27;</span>) <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        os.mkdir(<span class="hljs-string">&#x27;log/&#x27;</span>)<br>    <span class="hljs-keyword">global</span> _console_logger, _warn_logger, _error_logger<br>    handler = logging.handlers.RotatingFileHandler(<br>        CONSOLE_FILENAME, maxBytes=<span class="hljs-number">20</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>, backupCount=<span class="hljs-number">5</span>)<br>    hdr = logging.StreamHandler()<br>    _console_logger = logging.getLogger(<span class="hljs-string">&#x27;debug&#x27;</span>)<br>    _console_logger.addHandler(handler)<br>    _console_logger.addHandler(hdr)<br>    _console_logger.setLevel(logging.DEBUG)<br><br>    handler = logging.handlers.RotatingFileHandler(<br>        WARNING_FILENAME, maxBytes=<span class="hljs-number">20</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>, backupCount=<span class="hljs-number">5</span>)<br>    hdr = logging.StreamHandler()<br>    _warn_logger = logging.getLogger(<span class="hljs-string">&#x27;warn&#x27;</span>)<br>    _warn_logger.addHandler(handler)<br>    _warn_logger.addHandler(hdr)<br>    _warn_logger.setLevel(logging.WARN)<br><br>    handler = logging.handlers.RotatingFileHandler(<br>        ERROR_FILENAME, maxBytes=<span class="hljs-number">20</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>, backupCount=<span class="hljs-number">5</span>)<br>    hdr = logging.StreamHandler()<br>    _error_logger = logging.getLogger(<span class="hljs-string">&#x27;error&#x27;</span>)<br>    _error_logger.addHandler(handler)<br>    _error_logger.addHandler(hdr)<br>    _error_logger.setLevel(logging.ERROR)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dlog</span>(<span class="hljs-params">msg</span>):<br>    file_name, file_no, unused = find_caler()<br>    time_str = datetime.datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)<br>    _console_logger.debug(<span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (time_str, <span class="hljs-string">&#x27;debug&#x27;</span>, file_name, file_no, msg))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ilog</span>(<span class="hljs-params">msg</span>):<br>    file_name, file_no, unused = find_caler()<br>    time_str = datetime.datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)<br>    _console_logger.info(<span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (time_str, <span class="hljs-string">&#x27;info&#x27;</span>, file_name, file_no, msg))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wlog</span>(<span class="hljs-params">msg</span>):<br>    file_name, file_no, unused = find_caler()<br>    time_str = datetime.datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)<br>    _console_logger.warn(<span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (time_str, <span class="hljs-string">&#x27;warning&#x27;</span>, file_name, file_no, msg))<br>    _warn_logger.warn(<span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (time_str, <span class="hljs-string">&#x27;warning&#x27;</span>, file_name, file_no, msg))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">elog</span>(<span class="hljs-params">msg</span>):<br>    file_name, file_no, unused = find_caler()<br>    time_str = datetime.datetime.now().strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)<br>    _console_logger.error(<span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (time_str, <span class="hljs-string">&#x27;error&#x27;</span>, file_name, file_no, msg))<br>    _error_logger.error(<span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (time_str, <span class="hljs-string">&#x27;error&#x27;</span>, file_name, file_no, msg))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_caler</span>():<br>    f = sys._getframe(<span class="hljs-number">2</span>)<br>    co = f.f_code<br>    <span class="hljs-keyword">return</span> (os.path.basename(co.co_filename), f.f_lineno, co.co_name) <span class="hljs-keyword">if</span> co != <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> (<span class="hljs-string">&#x27;unknown&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;unknown&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    log_init()<br>    dlog(<span class="hljs-string">&#x27;test.log %d&#x27;</span>%(<span class="hljs-number">123</span>))<br>    ilog(<span class="hljs-string">&#x27;test.log %d&#x27;</span> % (<span class="hljs-number">123</span>))<br>    wlog(<span class="hljs-string">&#x27;test.log %d&#x27;</span> % (<span class="hljs-number">123</span>))<br>    elog(<span class="hljs-string">&#x27;test.log %d&#x27;</span> % (<span class="hljs-number">123</span>))<br><br></code></pre></td></tr></table></figure>

<p>单元测试代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Created on 10/10/17 11:27 AM</span><br><span class="hljs-string">@author: Chen Liang</span><br><span class="hljs-string">@function: 日志模块  单元测试</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">import</span> sys<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-keyword">import</span> unittest<br><span class="hljs-keyword">import</span> mock<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> qk_log <span class="hljs-keyword">import</span> log_init, dlog, ilog, wlog, elog<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestQkLog</span>(unittest.TestCase):<br>    dt_str = datetime.datetime.strptime(<span class="hljs-string">&#x27;2017-10-11 11:08:59&#x27;</span>, <span class="hljs-string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)<br><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.os.path&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.datetime.datetime&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.logging&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.find_caler&#x27;</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_dlog</span>(<span class="hljs-params">self, mock_caler, mock_logging, mock_datetime, mock_path</span>):<br>        mock_path.exists.return_value = <span class="hljs-literal">True</span><br>        log_init()<br>        self.assertFalse(mock_logging.getLogger(<span class="hljs-string">&#x27;debug&#x27;</span>).debug.called, <span class="hljs-string">&quot;Failed to not write log.&quot;</span>)<br><br>        mock_caler.return_value = (<span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        mock_datetime.now.return_value = self.dt_str<br>        dlog(<span class="hljs-string">&#x27;any msg&#x27;</span>)<br>        mock_logging.getLogger(<span class="hljs-string">&#x27;debug&#x27;</span>).debug.assert_called_with(<br>            <span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (<span class="hljs-string">&#x27;2017-10-11 11:08:59&#x27;</span>, <span class="hljs-string">&#x27;debug&#x27;</span>, <span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;any msg&#x27;</span>))<br><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.os.path&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.datetime.datetime&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.logging&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.find_caler&#x27;</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_ilog</span>(<span class="hljs-params">self, mock_caler, mock_logging, mock_datetime, mock_path</span>):<br>        mock_path.exists.return_value = <span class="hljs-literal">True</span><br>        log_init()<br>        self.assertFalse(mock_logging.getLogger(<span class="hljs-string">&#x27;debug&#x27;</span>).info.called, <span class="hljs-string">&quot;Failed to not write log.&quot;</span>)<br>        mock_caler.return_value = (<span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        mock_datetime.now.return_value = self.dt_str<br>        ilog(<span class="hljs-string">&#x27;any msg&#x27;</span>)<br>        mock_logging.getLogger(<span class="hljs-string">&#x27;debug&#x27;</span>).info.assert_called_with(<br>            <span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (<span class="hljs-string">&#x27;2017-10-11 11:08:59&#x27;</span>, <span class="hljs-string">&#x27;info&#x27;</span>, <span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;any msg&#x27;</span>))<br><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.os.path&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.datetime.datetime&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.logging&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.find_caler&#x27;</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_wlog</span>(<span class="hljs-params">self, mock_caler, mock_logging, mock_datetime, mock_path</span>):<br>        mock_path.exists.return_value = <span class="hljs-literal">True</span><br>        log_init()<br>        self.assertFalse(mock_logging.getLogger(<span class="hljs-string">&#x27;warn&#x27;</span>).info.called, <span class="hljs-string">&quot;Failed to not write log.&quot;</span>)<br>        mock_caler.return_value = (<span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        mock_datetime.now.return_value = self.dt_str<br>        wlog(<span class="hljs-string">&#x27;any msg&#x27;</span>)<br>        mock_logging.getLogger(<span class="hljs-string">&#x27;warn&#x27;</span>).warn.assert_called_with(<br>            <span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (<span class="hljs-string">&#x27;2017-10-11 11:08:59&#x27;</span>, <span class="hljs-string">&#x27;warning&#x27;</span>, <span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;any msg&#x27;</span>))<br><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.os.path&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.datetime.datetime&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.logging&#x27;</span></span>)</span><br><span class="hljs-meta">    @mock.patch(<span class="hljs-params"><span class="hljs-string">&#x27;qk_log.find_caler&#x27;</span></span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_elog</span>(<span class="hljs-params">self, mock_caler, mock_logging, mock_datetime, mock_path</span>):<br>        mock_path.exists.return_value = <span class="hljs-literal">True</span><br>        log_init()<br>        self.assertFalse(mock_logging.getLogger(<span class="hljs-string">&#x27;error&#x27;</span>).info.called, <span class="hljs-string">&quot;Failed to not write log.&quot;</span>)<br>        mock_caler.return_value = (<span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        mock_datetime.now.return_value = self.dt_str<br>        elog(<span class="hljs-string">&#x27;any msg&#x27;</span>)<br>        mock_logging.getLogger(<span class="hljs-string">&#x27;error&#x27;</span>).error.assert_called_with(<br>            <span class="hljs-string">&#x27;[%s] [%s] [%s,%d] %s&#x27;</span> % (<span class="hljs-string">&#x27;2017-10-11 11:08:59&#x27;</span>, <span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-string">&#x27;qk_log_test&#x27;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&#x27;any msg&#x27;</span>))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    unittest.main()<br><br></code></pre></td></tr></table></figure>

<h1 id="对单元测试的看法"><a href="#对单元测试的看法" class="headerlink" title="对单元测试的看法"></a>对单元测试的看法</h1><p>在一次整体改造Python数据统计分析项目时打算引进单元测试，在写完公共库的单元测试之后发现花费在单元测试上的时间较多，而且公共库不常改动，业务逻辑有比较混乱，因此团队决定放弃单元测试。对于以快速上线的初创公司和初创团队的项目来说，可以不用急着写单元测试，因为在一切改动都可能发生的情况下，再代码丢弃的时候对应的单元测试也就被丢弃了，浪费了过多的人力。</p>
<p>因此，初创团队不建议写单元测试，做好程序埋点和监控报警即可。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/python/" class="category-chain-item">python</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%B5%8B%E8%AF%95/">#测试</a>
      
        <a href="/tags/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">#单元测试</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Python单元测试</div>
      <div>https://suncle.me/2017/11/14/python单元测试/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Suncle Chen</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2017年11月14日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2017/11/20/erlang%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99behaviour/" title="Erlang设计原则Behaviour">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Erlang设计原则Behaviour</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2017/11/13/%E7%81%B5%E9%AD%82%E7%8B%AC%E6%97%85%E4%B9%8B%E5%A3%AE%E7%BE%8E%E9%BB%84%E5%B1%B1/" title="灵魂独旅之壮美黄山">
                        <span class="hidden-mobile">灵魂独旅之壮美黄山</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'suncle1993/suncle1993.github.io');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
